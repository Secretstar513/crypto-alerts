{{ define "base" }}
<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Crypto Alerts</title>
  <link rel="stylesheet" href="/static/style.css"/>
  <script src="/static/htmx.min.js"></script>
</head>
<body>
<header>
  <div class="brand">Crypto Alerts</div>
  <nav>
    <a href="/" {{if eq .Page "alerts"}}class="active"{{end}}>Alerts</a>
    <a href="/channels" {{if eq .Page "channels"}}class="active"{{end}}>Channels</a>
  </nav>
</header>

<main>
  {{ if eq .Page "alerts" }}
    {{ template "alerts_page" . }}
  {{ else if eq .Page "channels" }}
    {{ template "channels_page" . }}
  {{ end }}
</main>

<div id="toast"></div>

<script>
  (function(){
    const hostId = 'toast';
    const host = document.getElementById(hostId);
  
    function makeToast(kind, msg, timeout=2600){
      const el = document.createElement('div');
      el.className = `toast toast-${kind}`;
      el.innerHTML = `
        <div class="toast-dot"></div>
        <div class="toast-msg">${msg}</div>
        <button class="toast-x" aria-label="Close">Ã—</button>
      `;
      el.querySelector('.toast-x').onclick = () => el.remove();
      host.appendChild(el);
      requestAnimationFrame(()=> el.classList.add('in'));
      setTimeout(()=> {
        el.classList.remove('in');
        setTimeout(()=> el.remove(), 180);
      }, timeout);
    }
  
    window.toast = {
      ok: (m)=> makeToast('ok', m),
      err: (m)=> makeToast('err', m),
      info:(m)=> makeToast('info', m),
    };
  
    document.addEventListener('alert-changed', ()=> toast.ok('Alerts updated'));
    document.addEventListener('channels-saved', ()=> toast.ok('Channel settings saved'));
  })();
  </script>
</body>
</html>
{{ end }}
 